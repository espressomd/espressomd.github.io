<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: ResourceCleanup Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo_100x100.png"/></td>
  <td id="projectalign">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classResourceCleanup.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classResourceCleanup-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ResourceCleanup Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Queue to deallocate resources before normal program termination.  
 <a href="classResourceCleanup.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResourceCleanup_1_1Attorney.html">Attorney</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attorney for a resource deallocator.  <a href="classResourceCleanup_1_1Attorney.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a238df11abdba20d183548e90bd20e61a" id="r_a238df11abdba20d183548e90bd20e61a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResourceCleanup.html#a238df11abdba20d183548e90bd20e61a">ResourceCleanup</a> ()=<a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">default</a></td></tr>
<tr class="separator:a238df11abdba20d183548e90bd20e61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad099d2a53e824ebaa61b38043df0013f" id="r_ad099d2a53e824ebaa61b38043df0013f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResourceCleanup.html#ad099d2a53e824ebaa61b38043df0013f">~ResourceCleanup</a> ()</td></tr>
<tr class="separator:ad099d2a53e824ebaa61b38043df0013f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6c7b294a81d1d2496790236cb79a1e9" id="r_ad6c7b294a81d1d2496790236cb79a1e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">auto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResourceCleanup.html#ad6c7b294a81d1d2496790236cb79a1e9">size</a> () <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">const</a></td></tr>
<tr class="separator:ad6c7b294a81d1d2496790236cb79a1e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447d880c443df36d1867cd9713eebdc5" id="r_a447d880c443df36d1867cd9713eebdc5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">auto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResourceCleanup.html#a447d880c443df36d1867cd9713eebdc5">empty</a> () <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">const</a></td></tr>
<tr class="separator:a447d880c443df36d1867cd9713eebdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6dc80fd135467c4084c2ee871973685" id="r_aa6dc80fd135467c4084c2ee871973685"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">typename</a> <a class="el" href="classResourceCleanup_1_1Attorney.html">Attorney</a> , <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">typename</a> Container &gt; </td></tr>
<tr class="memitem:aa6dc80fd135467c4084c2ee871973685"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classResourceCleanup.html#aa6dc80fd135467c4084c2ee871973685">push</a> (std::shared_ptr&lt; Container &gt; <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">const</a> &amp;<a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">resource</a>)</td></tr>
<tr class="memdesc:aa6dc80fd135467c4084c2ee871973685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a resource for cleanup.  <br /></td></tr>
<tr class="separator:aa6dc80fd135467c4084c2ee871973685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Queue to deallocate resources before normal program termination. </p>
<p>Some resources can only be deallocated when a static global object is still alive, for example a MPI manager, a GPU context or a file handle. This class can be registered as a callback for normal program termination; any registered resource that didn't expire will be forcefully deallocated.</p>
<p>To this end, the "client" class needs to implement cleanup methods that deallocate managed resources, to be called by the class destructor when the instance lifetime expires, or by an "attorney" class at normal program termination, whichever comes first. The attorney class creates a callback that is pushed in a queue that gets processed before normal program termination at the user's discretion, or when the queue itself expires, if the client class instance hasn't expired already.</p>
<p>Please note the cleanup methods need to be able to run twice, since the client class destructor will be called eventually, possibly after <code>__run_exit_handlers()</code> is called. The attorney-client idiom is used to make the private deallocation methods accessible to the cleanup callbacks. </p>

<p class="definition">Definition at line <a class="el" href="ResourceCleanup_8hpp_source.html#l00047">47</a> of file <a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a238df11abdba20d183548e90bd20e61a" name="a238df11abdba20d183548e90bd20e61a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a238df11abdba20d183548e90bd20e61a">&#9670;&#160;</a></span>ResourceCleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ResourceCleanup::ResourceCleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad099d2a53e824ebaa61b38043df0013f" name="ad099d2a53e824ebaa61b38043df0013f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad099d2a53e824ebaa61b38043df0013f">&#9670;&#160;</a></span>~ResourceCleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ResourceCleanup::~ResourceCleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ResourceCleanup_8hpp_source.html#l00056">56</a> of file <a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>.</p>

<p class="reference">References <a class="el" href="common__cuda_8cu_source.html#l00034">stream</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a447d880c443df36d1867cd9713eebdc5" name="a447d880c443df36d1867cd9713eebdc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447d880c443df36d1867cd9713eebdc5">&#9670;&#160;</a></span>empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">auto</a> ResourceCleanup::empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ResourceCleanup_8hpp_source.html#l00142">142</a> of file <a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>.</p>

</div>
</div>
<a id="aa6dc80fd135467c4084c2ee871973685" name="aa6dc80fd135467c4084c2ee871973685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6dc80fd135467c4084c2ee871973685">&#9670;&#160;</a></span>push()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">typename</a> <a class="el" href="classResourceCleanup_1_1Attorney.html">Attorney</a> , <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">typename</a> Container &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">void</a> ResourceCleanup::push </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; Container &gt; <a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">const</a> &amp;&#160;</td>
          <td class="paramname"><em>resource</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register a resource for cleanup. </p>
<p>Internally, a weak pointer is created and stored in a callback. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Attorney</td><td>Specialization of <a class="el" href="classResourceCleanup_1_1Attorney.html">ResourceCleanup::Attorney</a> that wraps the class <code>Container</code> deallocator. </td></tr>
    <tr><td class="paramname">Container</td><td>Class that manages resources. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ResourceCleanup_8hpp_source.html#l00152">152</a> of file <a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>.</p>

<p class="reference">References <a class="el" href="common__cuda_8cu_source.html#l00034">stream</a>.</p>

<p class="reference">Referenced by <a class="el" href="GpuParticleData__cuda_8cu_source.html#l00120">GpuParticleData::Storage::make_shared()</a>.</p>

</div>
</div>
<a id="ad6c7b294a81d1d2496790236cb79a1e9" name="ad6c7b294a81d1d2496790236cb79a1e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6c7b294a81d1d2496790236cb79a1e9">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common__cuda_8cu.html#a2edcfbb6549e85581562bf5ed89d2008">auto</a> ResourceCleanup::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ResourceCleanup_8hpp_source.html#l00141">141</a> of file <a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ResourceCleanup_8hpp_source.html">ResourceCleanup.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classResourceCleanup.html">ResourceCleanup</a></li>
    <li class="footer">Generated on Sat Nov 1 2025 02:27:01 for ESPResSo by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>17. Online-visualization &#8212; ESPResSo 4.2.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/blockquotes.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/toggleprompt.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="18. Advanced methods" href="advanced_methods.html" />
    <link rel="prev" title="16. Input and Output" href="io.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="online-visualization">
<span id="id1"></span><h1><span class="section-number">17. </span>Online-visualization<a class="headerlink" href="#online-visualization" title="Permalink to this headline">¶</a></h1>
<p><em>ESPResSo</em> offers a direct rendering engine based on <em>pyopengl</em>.
It supports several features like shape-based constraints,
particle properties, the cell system, lattice-Boltzmann and more.
It can be adjusted with a large number of parameters to set colors,
materials, camera and interactive features like assigning callbacks
to user input. It requires the Python module <em>PyOpenGL</em>.
It is not meant to produce high quality renderings, but rather to
debug the simulation setup and equilibration process.</p>
<section id="general-usage">
<span id="id2"></span><h2><span class="section-number">17.1. </span>General usage<a class="headerlink" href="#general-usage" title="Permalink to this headline">¶</a></h2>
<p>The recommended usage is to instantiate the visualizer and pass it the
<a class="reference internal" href="espressomd.html#espressomd.system.System" title="espressomd.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">espressomd.System()</span></code></a> object. Then write
your integration loop in a separate function, which is started in a
non-blocking thread. Whenever needed, call <code class="docutils literal notranslate"><span class="pre">update()</span></code> to synchronize
the renderer with your system. Finally start the blocking visualization
window with <code class="docutils literal notranslate"><span class="pre">start()</span></code>. See the following minimal code example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">espressomd</span>
<span class="kn">import</span> <span class="nn">espressomd.visualization</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box_l</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">cell_system</span><span class="o">.</span><span class="n">skin</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">system</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.00001</span>

<span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">visualizer</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main_thread</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">visualizer</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">main_thread</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="setting-up-the-visualizer">
<span id="id3"></span><h2><span class="section-number">17.2. </span>Setting up the visualizer<a class="headerlink" href="#setting-up-the-visualizer" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive" title="espressomd.visualization.openGLLive"><code class="xref py py-class docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive()</span></code></a></p>
<p>The required parameter  <code class="docutils literal notranslate"><span class="pre">system</span></code> is the <a class="reference internal" href="espressomd.html#espressomd.system.System" title="espressomd.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> object.
The optional keywords in <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> are used to adjust the appearance of the visualization.
These parameters have suitable default values for most simulations.</p>
<p><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.update" title="espressomd.visualization.openGLLive.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.update()</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">update()</span></code> synchronizes system and visualizer, handles keyboard events for
openGLLive.</p>
<p><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.start" title="espressomd.visualization.openGLLive.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.start()</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">start()</span></code> starts the blocking visualizer window.
Should be called after a separate thread containing <code class="docutils literal notranslate"><span class="pre">update()</span></code> has been started.</p>
<p><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.register_callback" title="espressomd.visualization.openGLLive.register_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.register_callback()</span></code></a></p>
<p>Registers the method <code class="docutils literal notranslate"><span class="pre">callback()</span></code>, which is called every <code class="docutils literal notranslate"><span class="pre">interval</span></code> milliseconds. Useful for
live plotting (see sample script <code class="file docutils literal notranslate"><span class="pre">/samples/visualization_ljliquid.py</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The visualization of some constraints is either improved by (<a class="reference internal" href="espressomd.html#espressomd.shapes.SimplePore" title="espressomd.shapes.SimplePore"><code class="xref py py-class docutils literal notranslate"><span class="pre">espressomd.shapes.SimplePore</span></code></a>)
or even relies on (<a class="reference internal" href="espressomd.html#espressomd.shapes.HollowConicalFrustum" title="espressomd.shapes.HollowConicalFrustum"><code class="xref py py-class docutils literal notranslate"><span class="pre">espressomd.shapes.HollowConicalFrustum</span></code></a>) the presence of an installed
<cite>OpenGL Extrusion library</cite> on your system. Typically, the library will be available through the
default package manager of your operating system. On Ubuntu the required package is called <code class="docutils literal notranslate"><span class="pre">libgle3-dev</span></code>,
on Fedora <code class="docutils literal notranslate"><span class="pre">libgle</span></code> – just to name two examples.</p>
</div>
<section id="running-the-visualizer">
<span id="id4"></span><h3><span class="section-number">17.2.1. </span>Running the visualizer<a class="headerlink" href="#running-the-visualizer" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.run" title="espressomd.visualization.openGLLive.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.run()</span></code></a></p>
<p>To visually debug your simulation, <code class="docutils literal notranslate"><span class="pre">run(n)</span></code> can be used to conveniently start
an integration loop with <code class="docutils literal notranslate"><span class="pre">n</span></code> integration steps in a separate thread once the
visualizer is initialized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">espressomd</span>
<span class="kn">import</span> <span class="nn">espressomd.visualization</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box_l</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">cell_system</span><span class="o">.</span><span class="n">skin</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">system</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.0001</span>

<span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">visualizer</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="screenshots">
<span id="id5"></span><h3><span class="section-number">17.2.2. </span>Screenshots<a class="headerlink" href="#screenshots" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.screenshot" title="espressomd.visualization.openGLLive.screenshot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.screenshot()</span></code></a></div>
</div>
<p>The OpenGL visualizer can also be used for offline rendering.
After creating the visualizer object, call <code class="docutils literal notranslate"><span class="pre">screenshot(path)</span></code>
to save an image of your simulation to <code class="docutils literal notranslate"><span class="pre">path</span></code>. Internally, the image is saved
with <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.imsave</span></code>, so the file format is specified by the
extension of the filename.  The image size is determined by the keyword
argument <code class="docutils literal notranslate"><span class="pre">window_size</span></code> of the visualizer. This method can be used to create
screenshots without blocking the simulation script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">espressomd</span>
<span class="kn">import</span> <span class="nn">espressomd.visualization</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box_l</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">cell_system</span><span class="o">.</span><span class="n">skin</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">system</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">system</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">set_langevin</span><span class="p">(</span><span class="n">kT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">visualizer</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">visualizer</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;screenshot_</span><span class="si">{i:0&gt;5}</span><span class="s1">.png&#39;</span><span class="p">)</span>

<span class="c1"># You may consider creating a video with ffmpeg:</span>
<span class="c1"># ffmpeg -f image2 -framerate 30 -i &#39;screenshot_%05d.png&#39; output.mp4</span>
</pre></div>
</div>
<p>It is also possible to create a snapshot during online visualization.
Simply press the <em>enter</em> key to create a snapshot of the current window,
which saves it to <code class="file docutils literal notranslate"><span class="pre">&lt;scriptname&gt;_n.png</span></code> (with incrementing <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
</section>
<section id="colors-and-materials">
<span id="id6"></span><h3><span class="section-number">17.2.3. </span>Colors and Materials<a class="headerlink" href="#colors-and-materials" title="Permalink to this headline">¶</a></h3>
<p>Colors for particles, bonds and constraints are specified by RGB arrays.
Materials by an array for the ambient, diffuse, specular and shininess and opacity (ADSSO)
components. To distinguish particle groups, arrays of RGBA or ADSSO entries are
used, which are indexed circularly by the numerical particle type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Particle type 0 is red, type 1 is blue (type 2 is red etc)..</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">,</span>
                                                 <span class="n">particle_coloring</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
                                                 <span class="n">particle_type_colors</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">particle_type_materials</span></code> lists the materials by type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Particle type 0 is gold, type 1 is blue (type 2 is gold again etc).</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">,</span>
                                                 <span class="n">particle_coloring</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span>
                                                 <span class="n">particle_type_colors</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                                                 <span class="n">particle_type_materials</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;steel&quot;</span><span class="p">,</span> <span class="s2">&quot;bright&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Materials are stored in <a class="reference internal" href="espressomd.html#espressomd.visualization.openGLLive.materials" title="espressomd.visualization.openGLLive.materials"><code class="xref py py-attr docutils literal notranslate"><span class="pre">espressomd.visualization.openGLLive.materials</span></code></a>.</p>
</section>
<section id="visualize-vectorial-properties">
<span id="id7"></span><h3><span class="section-number">17.2.4. </span>Visualize vectorial properties<a class="headerlink" href="#visualize-vectorial-properties" title="Permalink to this headline">¶</a></h3>
<p>Most vectorial particle properties can be visualized by 3D-arrows on the
particles:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ext_force</span></code>: An external force. Activate with the keyword <code class="docutils literal notranslate"><span class="pre">ext_force_arrows</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>: The force acting on the particle. Activate with the keyword <code class="docutils literal notranslate"><span class="pre">force_arrows</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code>: The velocity of the particle. Activate with the keyword <code class="docutils literal notranslate"><span class="pre">velocity_arrows</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">director</span></code>: A vector associated with the orientation of the particle. Activate with the keyword <code class="docutils literal notranslate"><span class="pre">director_arrows</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p></li>
</ul>
<p>Arrow colors, scales and radii can be adjusted. Again, the lists specifying
these quantities are indexed circularly by the numerical particle type. The
following code snippet demonstrates the visualization of the director property
and individual settings for two particle types (requires the <code class="docutils literal notranslate"><span class="pre">ROTATION</span></code>
feature):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">espressomd</span>
<span class="kn">from</span> <span class="nn">espressomd.visualization</span> <span class="k">import</span> <span class="n">openGLLive</span><span class="p">,</span> <span class="n">KeyboardButtonEvent</span><span class="p">,</span> <span class="n">KeyboardFireEvent</span>

<span class="n">box_l</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">espressomd</span><span class="o">.</span><span class="n">System</span><span class="p">(</span><span class="n">box_l</span><span class="o">=</span><span class="p">[</span><span class="n">box_l</span><span class="p">,</span> <span class="n">box_l</span><span class="p">,</span> <span class="n">box_l</span><span class="p">])</span>
<span class="n">system</span><span class="o">.</span><span class="n">cell_system</span><span class="o">.</span><span class="n">skin</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">system</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="mf">0.00001</span>

<span class="n">visualizer</span> <span class="o">=</span> <span class="n">openGLLive</span><span class="p">(</span><span class="n">system</span><span class="p">,</span>
                        <span class="n">director_arrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">director_arrows_type_scale</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                        <span class="n">director_arrows_type_radii</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
                        <span class="n">director_arrows_type_colors</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">box_l</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">ext_torque</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">system</span><span class="o">.</span><span class="n">part</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">box_l</span><span class="p">,</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                    <span class="n">ext_torque</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="controls">
<span id="id8"></span><h3><span class="section-number">17.2.5. </span>Controls<a class="headerlink" href="#controls" title="Permalink to this headline">¶</a></h3>
<p>The camera can be controlled via mouse and keyboard:</p>
<ul class="simple">
<li><p>hold left button: rotate the system</p></li>
<li><p>hold right button: translate the system</p></li>
<li><p>hold middle button: zoom / roll</p></li>
<li><p>mouse wheel / key pair TG: zoom</p></li>
<li><p>WASD-Keyboard control (WS: move forwards/backwards, AD: move sidewards)</p></li>
<li><p>Key pairs QE, RF, ZC: rotate the system</p></li>
<li><p>Double click on a particle: Show particle information</p></li>
<li><p>Double click in empty space: Toggle system information</p></li>
<li><p>Left/Right arrows: Cycle through particles</p></li>
<li><p>Space: If started with <code class="docutils literal notranslate"><span class="pre">run(n)</span></code>, this pauses the simulation</p></li>
<li><p>Enter: Creates a snapshot of the current window and saves it to <code class="file docutils literal notranslate"><span class="pre">&lt;scriptname&gt;_n.png</span></code> (with incrementing <code class="docutils literal notranslate"><span class="pre">n</span></code>)</p></li>
</ul>
<p>Additional input functionality for mouse and keyboard is possible by assigning
callbacks to specified keyboard or mouse buttons. This may be useful for
realtime adjustment of system parameters (temperature, interactions, particle
properties, etc.) or for demonstration purposes. The callbacks can be triggered
by a timer or keyboard input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>

<span class="c1"># Registers timed calls of foo()</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># Callbacks to control temperature</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">system</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">set_langevin</span><span class="p">(</span><span class="n">kT</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">increaseTemp</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">temperature</span>
    <span class="n">temperature</span> <span class="o">+=</span> <span class="mf">0.5</span>
    <span class="n">system</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">set_langevin</span><span class="p">(</span><span class="n">kT</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;T = {system.thermostat.get_state()[0][&#39;kT&#39;]:.1f}&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decreaseTemp</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">temperature</span>
    <span class="n">temperature</span> <span class="o">-=</span> <span class="mf">0.5</span>
    <span class="k">if</span> <span class="n">temperature</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">system</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">set_langevin</span><span class="p">(</span><span class="n">kT</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;T = {system.thermostat.get_state()[0][&#39;kT&#39;]:.1f}&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">system</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;T = 0&quot;</span><span class="p">)</span>

<span class="c1"># Registers input-based calls with keys Y and H</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">keyboard_manager</span><span class="o">.</span><span class="n">register_button</span><span class="p">(</span><span class="n">KeyboardButtonEvent</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">KeyboardFireEvent</span><span class="o">.</span><span class="n">Hold</span><span class="p">,</span> <span class="n">increaseTemp</span><span class="p">))</span>
<span class="n">visualizer</span><span class="o">.</span><span class="n">keyboard_manager</span><span class="o">.</span><span class="n">register_button</span><span class="p">(</span><span class="n">KeyboardButtonEvent</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">KeyboardFireEvent</span><span class="o">.</span><span class="n">Hold</span><span class="p">,</span> <span class="n">decreaseTemp</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Further examples can be found in <code class="file docutils literal notranslate"><span class="pre">/samples/billiard.py</span></code> or <code class="file docutils literal notranslate"><span class="pre">/samples/visualization_interactive.py</span></code>.</p>
</section>
<section id="dragging-particles">
<span id="id9"></span><h3><span class="section-number">17.2.6. </span>Dragging particles<a class="headerlink" href="#dragging-particles" title="Permalink to this headline">¶</a></h3>
<p>With the keyword <code class="docutils literal notranslate"><span class="pre">drag_enabled</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the mouse can be used to
exert a force on particles in drag direction (scaled by <code class="docutils literal notranslate"><span class="pre">drag_force</span></code> and the
distance of particle and mouse cursor).</p>
</section>
</section>
<section id="visualization-example-scripts">
<span id="id10"></span><h2><span class="section-number">17.3. </span>Visualization example scripts<a class="headerlink" href="#visualization-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>Various <a class="reference internal" href="introduction.html#sample-scripts"><span class="std std-ref">Sample scripts</span></a> can be found in <code class="file docutils literal notranslate"><span class="pre">/samples/visualization_*.py</span></code>
or in the <a class="reference internal" href="introduction.html#tutorials"><span class="std std-ref">Tutorials</span></a> “Visualization” and “Charged Systems”.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">17. Online-visualization</a><ul>
<li><a class="reference internal" href="#general-usage">17.1. General usage</a></li>
<li><a class="reference internal" href="#setting-up-the-visualizer">17.2. Setting up the visualizer</a><ul>
<li><a class="reference internal" href="#running-the-visualizer">17.2.1. Running the visualizer</a></li>
<li><a class="reference internal" href="#screenshots">17.2.2. Screenshots</a></li>
<li><a class="reference internal" href="#colors-and-materials">17.2.3. Colors and Materials</a></li>
<li><a class="reference internal" href="#visualize-vectorial-properties">17.2.4. Visualize vectorial properties</a></li>
<li><a class="reference internal" href="#controls">17.2.5. Controls</a></li>
<li><a class="reference internal" href="#dragging-particles">17.2.6. Dragging particles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualization-example-scripts">17.3. Visualization example scripts</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018-2023, The ESPResSo project.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>